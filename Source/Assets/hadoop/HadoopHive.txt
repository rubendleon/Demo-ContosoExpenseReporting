select * from service_logs limit 10

CREATE EXTERNAL TABLE service_logs (
ipaddr STRING,
col2 STRING,
dates STRING,
times STRING, 
sevrdomain STRING, 
server STRING, 
option7 STRING, 
option8 STRING,
option9 STRING, 
option10 STRING, 
returncode STRING, 
option12 STRING, 
method STRING, 
content STRING, 
useragent STRING, 
refferal STRING, 
session STRING, 
option18 STRING,
partner STRING,
query STRING,
country STRING
)
COMMENT 'This is a service log sample'
ROW FORMAT DELIMITED FIELDS TERMINATED by '44'
STORED AS TEXTFILE
LOCATION 'asv://servicelogs/';



create table top_countries_teched as select country, count(country) as hitcount from service_logs group by country order by hitcount desc;



select country, hitcount from top_countries order by hitcount desc limit 10